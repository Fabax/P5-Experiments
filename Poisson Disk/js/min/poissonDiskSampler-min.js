function PoissonDiskSampler(){this.pointList=[],this.maxPoints=500,this.radiusMin=2,this.radiusMax=40,this.maxFails=500,this.pi2=2*Math.PI,this.w=800,this.h=600,this.distanceMap=null,this.excludeMap=null,this.excludeThreshold=0}PoissonDiskSampler.prototype.createPoints=function(){for(var t=0,i,s=0;t<this.maxPoints&&s<this.maxFails;)i=0===t?this.createfirstPoint():this.generateRandomAround(i),this.hitTest(i)?(this.pointList[t]=i,t++,s=0):s++},PoissonDiskSampler.prototype.hitTest=function(t){if(null!==this.excludeMap){var i=this.getExcludeMapPixel(t.x,t.y);if(i[0]<=this.excludeThreshold)return!1}var s=this.pointList.length,a=0,r=0,e=0,n=s,h;if(s>0)for(;n--;)if(h=this.pointList[n],r=h.x-t.x,e=h.y-t.y,a=Math.sqrt(r*r+e*e),a<=h.r+t.r)return!1;return!0},PoissonDiskSampler.prototype.createfirstPoint=function(){var t=parseInt(Math.random()*this.w,10),i=parseInt(Math.random()*this.h,10),s;if(null===this.distanceMap)s=parseInt(this.radiusMin+Math.random()*(this.radiusMax-this.radiusMin),10);else{var a=this.getHitMapPixel(t,i);s=this.radiusMin+(this.radiusMax-this.radiusMin)*(a[0]/255)}return{x:t,y:i,r:s}},PoissonDiskSampler.prototype.getExcludeMapPixel=function(t,i){return this.excludeMap.getImageData(t,i,1,1).data},PoissonDiskSampler.prototype.getHitMapPixel=function(t,i){return this.distanceMap.getImageData(t,i,1,1).data},PoissonDiskSampler.prototype.generateRandomAround=function(t){var i,s,a,r,e;if(i=Math.random(),s=parseInt(t.r+this.radiusMax*i,10),a=this.pi2*i,r=parseInt(t.x+s*Math.sin(a),10),e=parseInt(t.y+s*Math.cos(a),10),(0>=r||r>=this.w)&&(r=parseInt(i*this.w,10)),(0>=e||e>=this.h)&&(e=parseInt(i*this.h,10)),null===this.distanceMap)s=this.radiusMin+Math.random()*(this.radiusMax-this.radiusMin);else{var n=this.getHitMapPixel(r,e);s=this.radiusMin+(this.radiusMax-this.radiusMin)*(n[0]/255)}return{x:r,y:e,r:s}};