!function(t,e){"function"==typeof define&&define.amd?define("p5.dom",["p5"],function(t){e(t)}):e("object"==typeof exports?require("../p5"):t.p5)}(this,function(t){function e(e){return"VIDEO"===e.tagName||"AUDIO"===e.tagName?new t.MediaElement(e):new t.Element(e)}function i(e,i,n){var s=i._userNode?i._userNode:document.body;s.appendChild(e);var r=n?new t.MediaElement(e):new t.Element(e);return i._elements.push(r),r}function n(t,e,n,s){var r=document.createElement(e);"string"==typeof n&&(n=[n]);for(var o=0;o<n.length;o++){var a=document.createElement("source");a.src=n[o],r.appendChild(a)}"undefined"!=typeof s&&r.addEventListener("canplaythrough",function(){s()});var l=i(r,t,!0);return l.loadedmetadata=!1,r.addEventListener("loadedmetadata",function(){l.width=r.videoWidth,l.height=r.videoHeight,l.loadedmetadata=!0}),l}t.prototype.select=function(t){var i,n;return"."===t[0]?(n=t.slice(1),i=document.getElementsByClassName(n),i?e(i[0]):null):"#"===t[0]?(n=t.slice(1),i=document.getElementById(n),i?e(i):null):(i=document.getElementsByTagName(t),i?e(i[0]):null)},t.prototype.selectAll=function(t){var i=[],n,s;if("."===t[0]?(s=t.slice(1),n=document.getElementsByClassName(s)):n=document.getElementsByTagName(t),n)for(var r=0;r<n.length;r++){var o=e(n[r]);i.push(o)}return i},t.prototype.removeElements=function(t){for(var e=0;e<this._elements.length;e++)this._elements[e].elt instanceof HTMLCanvasElement||this._elements[e].remove()};var s=["div","p","span"];s.forEach(function(e){var n="create"+e.charAt(0).toUpperCase()+e.slice(1);t.prototype[n]=function(t){var n=document.createElement(e);return n.innerHTML=void 0===typeof t?"":t,i(n,this)}}),t.prototype.createImg=function(){var t=document.createElement("img"),e=arguments,n,s=function(){n.width=t.width,n.height=t.height,3===e.length&&"function"==typeof e[2]&&(n.fn=e[2],n.fn())};return t.src=e[0],e.length>1&&"string"==typeof e[1]&&(t.alt=e[1]),t.complete?s():t.onload=function(){s()},n=i(t,this)},t.prototype.createA=function(t,e,n){var s=document.createElement("a");return s.href=t,s.innerHTML=e,n&&(s.target=n),i(s,this)},t.prototype.createSlider=function(t,e,n,s){var r=document.createElement("input");return r.type="range",r.min=t,r.max=e,s&&(r.step=s),n&&(r.value=n),i(r,this)},t.prototype.createButton=function(t,e){var n=document.createElement("button");return n.innerHTML=t,n.value=e,e&&(n.value=e),i(n,this)},t.prototype.createInput=function(t){var e=document.createElement("input");return e.type="text",t&&(e.value=t),i(e,this)},t.prototype.createFileInput=function(e,n){function s(i){function n(i){var n=new t.File(i);return function(t){n.data=t.target.result,e(n)}}for(var s=i.target.files,r=0;r<s.length;r++){var o=s[r],a=new FileReader;a.onload=n(o),"text"===o.type?a.readAsText(o):a.readAsDataURL(o)}}if(window.File&&window.FileReader&&window.FileList&&window.Blob){var r=document.createElement("input");return r.type="file",n&&(r.multiple="multiple"),r.addEventListener("change",s,!1),i(r,this)}console.log("The File APIs are not fully supported in this browser. Cannot create element.")},t.prototype.createVideo=function(t,e){return n(this,"video",t,e)},t.prototype.createAudio=function(t,e){return n(this,"audio",t,e)},t.prototype.VIDEO="video",t.prototype.AUDIO="audio",navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,t.prototype.createCapture=function(){for(var e=!0,n=!0,s,r,o=0;o<arguments.length;o++)arguments[o]===t.prototype.VIDEO?n=!1:arguments[o]===t.prototype.AUDIO?e=!1:"object"==typeof arguments[o]?s=arguments[o]:"function"==typeof arguments[o]&&(r=arguments[o]);if(!navigator.getUserMedia)throw"getUserMedia not supported in this browser";var a=document.createElement("video");s||(s={video:e,audio:n}),navigator.getUserMedia(s,function(t){a.src=window.URL.createObjectURL(t),a.play(),r&&r(t)},function(t){console.log(t)});var l=i(a,this,!0);return l.loadedmetadata=!1,a.addEventListener("loadedmetadata",function(){l.width=a.videoWidth,l.height=a.videoHeight,l.loadedmetadata=!0}),l},t.prototype.createElement=function(t,e){var n=document.createElement(t);return"undefined"!=typeof e&&(n.innerHTML=e),i(n,this)},t.Element.prototype.addClass=function(t){return this.elt.className?this.elt.className=this.elt.className+" "+t:this.elt.className=t,this},t.Element.prototype.removeClass=function(t){var e=new RegExp("(?:^|\\s)"+t+"(?!\\S)");return this.elt.className=this.elt.className.replace(e,""),this.elt.className=this.elt.className.replace(/^\s+|\s+$/g,""),this},t.Element.prototype.child=function(e){return"string"==typeof e?e=document.getElementById(e):e instanceof t.Element&&(e=e.elt),this.elt.appendChild(e),this},t.Element.prototype.html=function(t){return"undefined"!=typeof t?(this.elt.innerHTML=t,this):this.elt.innerHTML},t.Element.prototype.position=function(){return 0===arguments.length?{x:this.elt.offsetLeft,y:this.elt.offsetTop}:(this.elt.style.position="absolute",this.elt.style.left=arguments[0]+"px",this.elt.style.top=arguments[1]+"px",this.x=arguments[0],this.y=arguments[1],this)},t.Element.prototype.translate=function(){if(this.elt.style.position="absolute",2===arguments.length){var t=this.elt.style.transform.replace(/translate3d\(.*\)/g,"");t=t.replace(/translate[X-Z]?\(.*\)/g,""),this.elt.style.transform="translate("+arguments[0]+"px, "+arguments[1]+"px)",this.elt.style.transform+=t}else if(3===arguments.length){var t=this.elt.style.transform.replace(/translate3d\(.*\)/g,"");t=t.replace(/translate[X-Z]?\(.*\)/g,""),this.elt.style.transform="translate3d("+arguments[0]+"px,"+arguments[1]+"px,"+arguments[2]+"px)",this.elt.style.transform+=t,this.elt.parentElement.style.perspective="1000px"}else if(4===arguments.length){var t=this.elt.style.transform.replace(/translate3d\(.*\)/g,"");t=t.replace(/translate[X-Z]?\(.*\)/g,""),this.elt.style.transform="translate3d("+arguments[0]+"px,"+arguments[1]+"px,"+arguments[2]+"px)",this.elt.style.transform+=t,this.elt.parentElement.style.perspective=arguments[3]+"px"}return this},t.Element.prototype.rotate=function(){if(1===arguments.length){var t=this.elt.style.transform.replace(/rotate3d\(.*\)/g,"");t=t.replace(/rotate[X-Z]?\(.*\)/g,""),this.elt.style.transform="rotate("+arguments[0]+"deg)",this.elt.style.transform+=t}else if(2===arguments.length){var t=this.elt.style.transform.replace(/rotate3d\(.*\)/g,"");t=t.replace(/rotate[X-Z]?\(.*\)/g,""),this.elt.style.transform="rotate("+arguments[0]+"deg, "+arguments[1]+"deg)",this.elt.style.transform+=t}else if(3===arguments.length){var t=this.elt.style.transform.replace(/rotate3d\(.*\)/g,"");t=t.replace(/rotate[X-Z]?\(.*\)/g,""),this.elt.style.transform="rotateX("+arguments[0]+"deg)",this.elt.style.transform+="rotateY("+arguments[1]+"deg)",this.elt.style.transform+="rotateZ("+arguments[2]+"deg)",this.elt.style.transform+=t}return this},t.Element.prototype.style=function(t,e){if("undefined"==typeof e)for(var i=t.split(";"),n=0;n<i.length;n++){var s=i[n].split(":");s[0]&&s[1]&&(this.elt.style[s[0].trim()]=s[1].trim())}else if(this.elt.style[t]=e,"width"===t||"height"===t||"left"===t||"top"===t){var r=e.replace(/\D+/g,"");this[t]=parseInt(r)}return this},t.Element.prototype.attribute=function(t,e){return"undefined"==typeof e?this.elt.getAttribute(t):(this.elt.setAttribute(t,e),this)},t.Element.prototype.value=function(){return arguments.length>0?(this.elt.value=arguments[0],this):"range"===this.elt.type?parseFloat(this.elt.value):this.elt.value},t.Element.prototype.show=function(){return this.elt.style.display="block",this},t.Element.prototype.hide=function(){return this.elt.style.display="none",this},t.Element.prototype.size=function(e,i){if(0===arguments.length)return{width:this.elt.offsetWidth,height:this.elt.offsetHeight};var n=e,s=i,r=t.prototype.AUTO;if(n!==r||s!==r){if(n===r?n=i*this.width/this.height:s===r&&(s=e*this.height/this.width),this.elt instanceof HTMLCanvasElement){var o={},a=this.elt.getContext("2d");for(var l in a)o[l]=a[l];this.elt.setAttribute("width",n*this._pInst._pixelDensity),this.elt.setAttribute("height",s*this._pInst._pixelDensity),this.elt.setAttribute("style","width:"+n+"px; height:"+s+"px"),this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity);for(var l in o)this.elt.getContext("2d")[l]=o[l]}else this.elt.style.width=n+"px",this.elt.style.height=s+"px",this.elt.width=n,this.elt.height=s,this.width=n,this.height=s;this.elt.style.overflow="hidden",this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this._pInst&&this._pInst._curElement.elt===this.elt&&(this._pInst._setProperty("width",this.elt.offsetWidth),this._pInst._setProperty("height",this.elt.offsetHeight))}return this},t.Element.prototype.remove=function(){for(var t in this._events)this.elt.removeEventListener(t,this._events[t]);this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt),delete this},t.MediaElement=function(e,i){t.Element.call(this,e,i),this._prevTime=0,this._cueIDCounter=0,this._cues=[]},t.MediaElement.prototype=Object.create(t.Element.prototype),t.MediaElement.prototype.play=function(){return this.elt.currentTime===this.elt.duration&&(this.elt.currentTime=0),this.elt.readyState>1?this.elt.play():(this.elt.load(),this.elt.play()),this},t.MediaElement.prototype.stop=function(){return this.elt.pause(),this.elt.currentTime=0,this},t.MediaElement.prototype.pause=function(){return this.elt.pause(),this},t.MediaElement.prototype.loop=function(){return this.elt.setAttribute("loop",!0),this.play(),this},t.MediaElement.prototype.noLoop=function(){return this.elt.setAttribute("loop",!1),this},t.MediaElement.prototype.autoplay=function(t){return this.elt.setAttribute("autoplay",t),this},t.MediaElement.prototype.volume=function(t){return"undefined"==typeof t?this.elt.volume:void(this.elt.volume=t)},t.MediaElement.prototype.time=function(t){return"undefined"==typeof t?this.elt.currentTime:void(this.elt.currentTime=t)},t.MediaElement.prototype.duration=function(){return this.elt.duration},t.MediaElement.prototype.pixels=[],t.MediaElement.prototype.loadPixels=function(){return this.loadedmetadata&&(this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.drawingContext=this.canvas.getContext("2d")),this.drawingContext.drawImage(this.elt,0,0,this.width,this.height),t.prototype.loadPixels.call(this)),this},t.MediaElement.prototype.updatePixels=function(e,i,n,s){return this.loadedmetadata&&t.prototype.updatePixels.call(this,e,i,n,s),this},t.MediaElement.prototype.get=function(e,i,n,s){return this.loadedmetadata?t.prototype.get.call(this,e,i,n,s):[0,0,0,255]},t.MediaElement.prototype.set=function(e,i,n){this.loadedmetadata&&t.prototype.set.call(this,e,i,n)},t.MediaElement.prototype.connect=function(e){var i,n;if("function"==typeof t.prototype.getAudioContext)i=t.prototype.getAudioContext(),n=t.soundOut.input;else try{i=e.context,n=i.destination}catch(s){throw"connect() is meant to be used with Web Audio API or p5.sound.js"}this.audioSourceNode||(this.audioSourceNode=i.createMediaElementSource(this.elt),this.audioSourceNode.connect(n)),e?e.input?this.audioSourceNode.connect(e.input):this.audioSourceNode.connect(e):this.audioSourceNode.connect(n)},t.MediaElement.prototype.disconnect=function(){if(!this.audioSourceNode)throw"nothing to disconnect";this.audioSourceNode.disconnect()},t.MediaElement.prototype.showControls=function(){this.elt.style["text-align"]="inherit",this.elt.controls=!0},t.MediaElement.prototype.hideControls=function(){this.elt.controls=!1},t.MediaElement.prototype.addCue=function(t,e,i){var n=this._cueIDCounter++,s=new r(e,t,n,i);return this._cues.push(s),this.elt.ontimeupdate||(this.elt.ontimeupdate=this._onTimeUpdate.bind(this)),n},t.MediaElement.prototype.removeCue=function(t){for(var e=0;e<this._cues.length;e++){var i=this._cues[e];i.id===t&&this.cues.splice(e,1)}0===this._cues.length&&(this.elt.ontimeupdate=null)},t.MediaElement.prototype.clearCues=function(){this._cues=[],this.elt.ontimeupdate=null},t.MediaElement.prototype._onTimeUpdate=function(){for(var t=this.time(),e=0;e<this._cues.length;e++){var i=this._cues[e].time,n=this._cues[e].val;this._prevTime<i&&t>=i&&this._cues[e].callback(n)}this._prevTime=t};var r=function(t,e,i,n){this.callback=t,this.time=e,this.id=i,this.val=n};t.File=function(t,e){this.file=t,this._pInst=e;var i=t.type.split("/");this.type=i[0],this.subtype=i[1],this.name=t.name,this.size=t.size,this.data=void 0}});